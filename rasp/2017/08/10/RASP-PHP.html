<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Fools Of Security are Information Security Enthusiast. We are an Open Source Knowledge sharing platform Relating to Information security and its advancements.">
  <meta name="author" content="Fools Of Security">
  <meta name="keywords" content="">
  <link rel="canonical" href="/rasp/2017/08/10/RASP-PHP.html">
  <title> Fools Of Security&ensp;| Injecting RASP (Runtime Application Self Protection) Security into Demo PHP Vuln App</title>

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link href="/css/grayscale.css" rel="stylesheet"><!-- Custom Fonts -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/rrssb.css" />
  <link rel="stylesheet" href="/css/custom.css" />
  <meta name="theme-color" content="#000000">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#000000">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
<!-- Syntax highlight in post pages -->
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/monokai_sublime.min.css"></head>
<body>
<nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
        <i class="fa fa-bars"></i>
      </button><a class="navbar-brand" href="/"><div><img src="/img/fos-border.ico" alt=""> Fools Of Security
          </div>
        </a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse navbar-right navbar-main-collapse">
      <ul class="nav navbar-nav"><!-- Blog, Post, Tag and Error pages --><li><a href="/#about"> About </a></li><li><a href="/blog/"> Blog </a></li><li><a href="/video/"> Video </a></li><li><a href="/#timeline"> Timeline </a></li><li><a href="/project/"> Project </a></li><li><a href="/#contact"> Contact </a></li></ul>
    </div>
  </div>
</nav>

<section id="post" class="container content-section text-center">
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
          <h1><strong>Injecting RASP (Runtime Application Self Protection) Security into Demo PHP Vuln App</strong></h1>
          <h4>
            <strong>10 Aug 2017</strong>
            <small>
              . category:
              <a class="category" href="/categories/rasp.html">
                rasp
              </a>.
              <a href="/rasp/2017/08/10/RASP-PHP.html#disqus_thread">Comments</a>
              <br /><a class="tag" href="/tags/tutorial.html">#tutorial</a></small>
          </h4>

          <section class="text-justify">
            <p>FOS-PHP Demo Vulnerable Application to test SQL injection vulnerability and patch it using RASP (Runtime Application Self-Protection)</p>

<p>Before  going further please know few thing about RASP or watch my previous video about RASP (Runtime Application Self Protection) Security in python. refer the link mentioned below. This  is about RASP Model for php application.</p>

<h3 id="requirement">Requirement:</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>#Vulnerable application: 
I have developed a Vulnerable PHP Application to demonstrate SQL Injection Vulnerability.(Available in my Github repository)

#RASP Model supported on PHP 5.6.x to 7.x 

#RASP(Written for PHP Application): 
It just begining model to show how RASP works to  prevent SQL injection in PHP Application.
In upcoming future video, i will demonstrate RASP With other OWASP Top 10 Vulnerabilities.

#Database:
Vulnerable php Application (Mysql):vuln-app (database name)
RASP Rule(Redis): Key:Value Concept (for better preformance)
</code></pre>
</div>
<p><br /></p>

<h3 id="how-it-works">How it works?</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>#Monkey patching:
Whenever user enter input to the application which is actually interacting with database to fetch data, RASP Will get hooked and 
monkey patch the Class Mysqli  to extract the query statement.

#Lexer Analysis and Token Generation:
Once the Query is extracted and processed into lexer analysis, it generate a token structure for the query.

#Redis:
Generated token structure are insert into redis as SQL Rule. 

whenever user enter some input into application which is actually interacting with database to fetch data, at that 
it will be check the user input structure with the SQL rule in redis to decide whether to block the user or 
allow the query to execute:)

#Running demo vuln app with out RASP:
 SQL injection is possible.

#Running demo vuln app with RASP :

#Learning mode
First, Run RASP in learning mode to make it understand the user input structure for the application to works.

In my RASP model i have threshold limit for SQL rule as 2 for demo. so only 2 rule are allowed into redis.
Threshold limit for sql rule depend up on the application.

Once RASP  learned all possible input structure from user and when it reached its limit. 
RASP will automatically run in Defending mode Now When have rules ready to block SQL injection attack :)

</code></pre>
</div>
<p><br /></p>
<h3 id="demo-video">Demo Video</h3>

<p><a href="https://www.youtube.com/watch?v=41IVmaXmOz0"><img src="https://img.youtube.com/vi/41IVmaXmOz0/0.jpg" alt="Alt text" /></a></p>

<h3 id="useful-links">Useful links:</h3>
<ol>
  <li><a href="https://www.youtube.com/watch?v=5yKH3nFZ9lY">[FOS] RASP (Runtime Application Self Protection) Security</a></li>
  <li><a href="https://github.com/umarfarook882/Tornado_Demo_Vuln_App">Demo Vulnerable App</a></li>
  <li><a href="https://www.kali.org/">Kali</a></li>
</ol>


          </section>
          <br><div class="sharing">
    <br/>
    <br/>
    <ul>
        <li><i class="fa fa-share-square-o"></i></li>
        
        <li><a href="mailto:?subject=Injecting RASP (Runtime Application Self Protection) Security into Demo PHP Vuln App&body=http://foolsofsecurity.com/rasp/2017/08/10/RASP-PHP.html" rel="nofollow" target="_blank" title="Share on Email">
                <i class="fa fa-envelope-square"></i>
        </a></li>
        
        
        <li><a href="http://www.linkedin.com/shareArticle?url=http://foolsofsecurity.com/rasp/2017/08/10/RASP-PHP.html&title=Injecting RASP (Runtime Application Self Protection) Security into Demo PHP Vuln App" rel="nofollow" target="_blank" title="Share on LinkedIn">
                <i class="fa fa-linkedin-square"></i>
        </a></li>
        
        
        <li><a href="https://twitter.com/intent/tweet?text=Injecting RASP (Runtime Application Self Protection) Security into Demo PHP Vuln App&url=http://foolsofsecurity.com/rasp/2017/08/10/RASP-PHP.html" rel="nofollow" target="_blank" title="Share on Twitter">
                <i class="fa fa-twitter-square"></i>
        </a></li>
        
        
        <li><a href="https://facebook.com/sharer.php?u=http://foolsofsecurity.com/rasp/2017/08/10/RASP-PHP.html" rel="nofollow" target="_blank" title="Share on Facebook">
                <i class="fa fa-facebook-square"></i>
        </a></li>
        

        
        <li><a href="https://plus.google.com/share?url=http://foolsofsecurity.com/rasp/2017/08/10/RASP-PHP.html" rel="nofollow" target="_blank" title="Share on Google+">
                <i class="fa fa-google-plus-square"></i>
        </a></li>
        

        
        <li><a href="http://reddit.com/submit?url=http://foolsofsecurity.com/rasp/2017/08/10/RASP-PHP.html&title=Injecting RASP (Runtime Application Self Protection) Security into Demo PHP Vuln App" rel="nofollow" target="_blank" title="Share on Reddit">
                <i class="fa fa-reddit-square"></i>
        </a></li>
        
        
        <li><a href="https://pinterest.com/pin/create/button/?url=http://foolsofsecurity.com/rasp/2017/08/10/RASP-PHP.html" rel="nofollow" target="_blank" title="Share on Pinterest">
                <i class="fa fa-pinterest-square"></i>
        </a></li>
        
    </ul>
</div>
<br/>
<br/><div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><hr /><div class="author row">
            <img class="col-xs-4 col-sm-3 col-md-2" src="/img/author.png" alt="Me" />
            <p class="col-xs-8 col-sm-9 col-md-10">
              Umar Farook is an Security Researcher & AppSec Enthusiast. He always approach App Security with innovative ideas  to explore and prevent Modern web application attacks. In spare time, he work on scrapying data from website and automating AppSec with Python.
            </p>
          </div></div>
      </div>
    </section>
<footer>
    <br>
<ul class="list-inline social-buttons"><li><a href="https://github.com/umarfarook882" target="_blank"><i class="fa fa-github fa-fw"></i></a></li><li><a href="https://www.youtube.com/channel/UCEBHO0kD1WFvIhf9wBCU-VQ" target="_blank"><i class="fa fa-youtube-play fa-fw"></i></a></li><li><a href="http://fosecurity.blogspot.in/" target="_blank"><i class="fa fa-globe fa-fw"></i></a></li></ul>

<p><br></p>
    <div class="container text-center">
        <p>Copyright &copy; Fools Of Security 2017</p><p style="font-size: 16px;"><a href="https://zerobin.net/?f1744fd662ccc911#AknpWQMXs3ZSDTvvgLTD67W7D9PrlI5vv06zDDG217I=" target="_blank"><i
                class="fa fa-key"></i> Fools of Security via PGP</a></p></div>
</footer>

<!-- Javascript Start -->
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

<script>
function toggleNavCollapse(){50<$(".navbar").offset().top?$(".navbar-fixed-top").addClass("top-nav-collapse"):$(".navbar-fixed-top").removeClass("top-nav-collapse");}
$(document).ready(toggleNavCollapse);
$(window).scroll(toggleNavCollapse);$(function(){$("a.page-scroll").bind("click",function(b){var a=$(this);$("html, body").stop().animate({scrollTop:$(a.attr("href")).offset().top-50},1500,"easeInOutExpo",function(){a.blur()});b.preventDefault()})});$(".navbar-collapse ul li a").click(function(){$(".navbar-toggle:visible").click()});
</script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript">
    var disqus_shortname = 'foolsofsecurity-com';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
  <script src="/js/rrssb.min.js"></script><script>
function addTohistory() {
  if (!window.location.host.startsWith("127.0.0.1")) {
    history.pushState({}, 'Injecting RASP (Runtime Application Self Protection) Security into Demo PHP Vuln App', 'http://foolsofsecurity.com/rasp/2017/08/10/RASP-PHP.html');
  }
}
</script>

<!-- Javascript End -->
</body>
</html>

